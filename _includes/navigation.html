<nav class="site-nav">
    <ul>
    {%- assign main_pages = site.pages | where: 'nav-level', '1' | sort: 'nav-order' -%}
    {% for page in main_pages %}
      {%- assign sub_pages = site.pages | where: 'nav-level', page.title | sort: 'nav-order' -%}
      <li{%- if sub_pages.size > 0 %} class="has-children"{% endif %}>
        {%- if sub_pages.size > 0 %}
        <details class="sub-nav">
          <summary>
        {%- endif %}
        <a href="{{ page.url }}">{% if (page.nav-title) %}{{ page.nav-title }}{% else %}{{ page.title }}{% endif %}</a>
        {%- if sub_pages.size > 0 %}
          </summary>
          <ul>
            {%- for child in sub_pages %}
            <li>
              <a href="{{ child.url }}">{% if (child.nav-title) %}{{ child.nav-title }}{% else %}{{ child.title }}{% endif %}</a>
            </li>
            {%- endfor %}
          </ul>
        </details>
        {%- endif %}
      </li>
    {%- endfor %}
    </ul>
    <div class="search-box">
    </div>
  </nav>